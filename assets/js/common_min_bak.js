function writeComment(){if(""!=$(this).children("#addComment").val()){var a=$(this).serialize();$.ajax({type:"POST",url:"/comment/add",data:a,success:function(a){},error:function(a){}})}}function likesActions(a,b,c){var d=$(this);if("undefined"!=a){var e;"user-like"==b&&(e=1),"user-dislike"==b&&(e=0),$.ajax({type:"POST",url:"/likes/"+c,data:{userId:a,subject:e},success:function(a){a.status===!0&&("addLike"===c&&d.addClass("active"),"removeLike"===c&&d.removeClass("active"),d.siblings("span").text(a.value))},error:function(a){}})}}function passActions(){$(this).hasClass("hidden-pass")?($(this).removeClass("hidden-pass"),$(this).addClass("show-pass"),$(this).siblings('input[type="password"]').attr("type","text")):$(this).hasClass("show-pass")&&($(this).removeClass("show-pass"),$(this).addClass("hidden-pass"),$(this).siblings('input[type="text"]').attr("type","password"))}function mainSearchAjaxStart(){$(document).ajaxStart(function(){$(".main-menu-content-block > .loading").removeClass("hidden")})}function mainSearchAjaxStop(){$(document).ajaxStop(function(){$(".main-menu-content-block > .loading").addClass("hidden")})}function setCityToDefault(){var a=$('#mainSearchForm p select[name="city"]');a.siblings(".selectboxit-container");a.find('option[value="0"]').prop("selected","selected"),a.select2()}function getMainSearchResult(a){$.ajax({type:"POST",url:"/users/getUsersByRating",data:a,success:function(a){addUsersToMainTable(a)},error:function(a){}})}function addUsersToMainTable(a,b){var c=$("#mainTablePeople"),d=$("#mainTablePeople tfoot .emptyResults"),e=c.find("thead"),f=c.find("tbody");if(void 0===b&&f.html(""),$.isEmptyObject(a))f.find(".js-link").length>0||d.removeClass("hidden");else{d.addClass("hidden");var g={},h=f.find(".js-link").length;$.each(a,function(a,b){if(g=e.find("tr.for-copy").clone(),g.removeClass("hidden for-copy"),g.attr("data-link","/user/?id="+b.id),g.find(".mt-position").text(h+a+1),null!=b.name&&g.find(".mt-name").find("span").text(b.name),null!=b.avatar){var c=g.find(".mt-name").find("img"),d=c.data("src");c.attr("src",d+b.avatar),null!=b.name&&c.attr("alt",b.name)}else{var c=g.find(".mt-name").find("img"),d=c.data("src");c.attr("src",d+"unknown.png"),null!=b.name&&c.attr("alt",b.name)}null!=b.rating&&(g.find(".mt-rating").find("span").text(b.rating),g.find(".mt-rating").append('<i class="rating-up"></i>')),null!=b.activ_name&&g.find(".mt-activity").text(b.activ_name),null!=b.country_name&&g.find(".mt-country").text(b.country_name),f.append(g)})}}function getCities(a){var b={};if(0!=a)b={countryId:a},$.ajax({type:"POST",url:"/city/getCities",data:b,success:function(a){addCitiesToSelect(a)},error:function(a){console.log(a)}});else{var c=$('#mainSearchForm select[name="city"]');c.attr("disabled","disabled"),c.find('option[value="0"]').attr("selected",!0),c.find("option:not(:first-child)").remove();var d=c.clone();d.insertAfter(c),c.siblings(".select2").remove(),d.select2(),c.remove()}}function addCitiesToSelect(a){var b=$('#mainSearchForm select[name="city"]');b.find("option:not(:first-child)").remove();var c=b.clone();c.append(),$.each(a,function(a,b){c.append('<option value="'+b.id+'">'+b.name+"</option>")}),c.removeAttr("disabled"),c.insertAfter(b),b.siblings(".select2").remove(),c.select2(),b.remove()}$(document).ready(function(){if($.browser.msie&&(9==$.browser.version||10==$.browser.version||11==$.browser.version)){var b=$('input[type="text"], input[type="phone"], textarea, input[type="password"]');$.each(b,function(a,b){var c=$(this).attr("placeholder");$(this).addClass("ie-9-plchld"),$(this).val(c)}),$(".ie-9-plchld").on("focus",function(){$(this).val("")}),$(".ie-9-plchld").on("blur",function(){$(this).val($(this).attr("placeholder"))})}$(".custom-select").select2(),$(".main-banner-aside").slick(),$(".socnet-slider-block").slick({slidesToShow:7,sliderToScroll:1}),$(".js-link").live("click",function(){var a=$(this).data("link");""!=a&&(location.href=a)}),$(".pass-action").on("click",function(){passActions.call(this)}),$("#mainSearchForm.active-search select").live("change",function(){var a=$(this).parents("#mainSearchForm").serialize();mainSearchAjaxStart(),getMainSearchResult(a),mainSearchAjaxStop()}),$('#mainSearchForm select[name="country"]').on("change",function(){var a=$(this).val();getCities(a)}),$("#mainSearchForm.active-search input").on("keyup",function(){var a=$(this).parents("#mainSearchForm").serialize();delay(function(){mainSearchAjaxStart(),getMainSearchResult(a),mainSearchAjaxStop()},1e3)}),$(".main-menu-aside .main-menu-header-block .block-header-title a").on("click",function(){$(".main-menu-aside .main-menu-enter-form-block").slideToggle(),$(".socnet-slider-block").slick("setPosition")}),$(".stats-like .stats-in-block i").click(function(){var a=$(this).parents(".stats-like").data("user-id"),b=$(this).attr("id"),c="addLike";$(this).parent(".stats-in-block").siblings(".stats-in-block").children("i").hasClass("active")||($(this).hasClass("active")&&(c="removeLike"),likesActions.call(this,a,b,c))}),$("#userCommentForm").on("submit",function(){writeComment.call(this)})});var delay=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),alreadyloading=!1,nextpage=2,context="",difference=!1;$(window).scroll(function(){if($("body").height()-.7*window.innerHeight<=window.innerHeight+$(window).scrollTop()&&(context!=$("#mainSearchForm.active-search select").parents("#mainSearchForm").serialize()?(context=$("#mainSearchForm.active-search select").parents("#mainSearchForm").serialize(),difference=!0,nextpage=2):difference=!1,0==alreadyloading||difference)){alreadyloading=!0,context!=$("#mainSearchForm.active-search select").parents("#mainSearchForm").serialize()?(context=$("#mainSearchForm.active-search select").parents("#mainSearchForm").serialize(),difference=!0):difference=!1;var a=context+"&page="+nextpage+"&per_page=20";$.ajax({type:"GET",url:"/users/getUsersByRating",data:a,success:function(a){a.length>0?(addUsersToMainTable(a,!0),alreadyloading=!1,nextpage++):alreadyloading=!0},error:function(a){}})}});